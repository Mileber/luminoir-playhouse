import{d as U,a as i,o as j,i as z,b as c,e as l,f as _,t as N,F as O,g as P,j as K,n as Z,h as d,_ as q}from"./index-LnyyPkwa.js";const J={class:"snake-game"},Q={class:"container"},V={class:"game-info"},W={class:"score"},X={class:"high-score"},Y={class:"controls"},ee={class:"game-board",ref:"gameBoard"},ae={key:0,class:"mobile-controls"},te={class:"control-row"},oe={class:"control-row"},le={key:1,class:"game-over"},r=15,H=150,se=50,ne=2,re=U({name:"SnakeGame",__name:"SnakeGame",setup(ie){const n=i([]),u=i([{x:7,y:7}]),o=i({x:5,y:5}),y=i("right"),w=i("right"),x=i(0),h=i(0),v=i(!1),g=i(!1),m=i(H),C=i(!1);let t=null;const R=()=>{n.value=Array(r).fill(0).map(()=>Array(r).fill(0))},$=e=>({"snake-head":e===2,"snake-body":e===1,food:e===3,empty:e===0}),E=()=>{R(),u.value=[{x:7,y:7}],y.value="right",w.value="right",A(),x.value=0,m.value=H,g.value=!1,B()},A=()=>{const e=[];for(let s=0;s<r;s++)for(let k=0;k<r;k++){let b=!1;for(const p of u.value)if(p.x===k&&p.y===s){b=!0;break}b||e.push({x:k,y:s})}if(e.length===0){g.value=!0,v.value=!1,t&&(clearInterval(t),t=null);return}const a=e[Math.floor(Math.random()*e.length)];o.value={x:a.x,y:a.y}},B=()=>{for(let e=0;e<r;e++)for(let a=0;a<r;a++)n.value[e]&&(n.value[e][a]=0);for(let e=0;e<u.value.length;e++){const a=u.value[e];a&&n.value[a.y]&&a.x!==void 0&&a.x>=0&&a.x<r&&a.y!==void 0&&a.y>=0&&a.y<r&&(e===0?n.value[a.y]&&a.x!==void 0&&a.y!==void 0&&(n.value[a.y][a.x]=2):n.value[a.y]&&a.x!==void 0&&a.y!==void 0&&(n.value[a.y][a.x]=1))}o.value&&n.value[o.value.y]&&o.value.x!==void 0&&o.value.x>=0&&o.value.x<r&&o.value.y!==void 0&&o.value.y>=0&&o.value.y<r&&n.value[o.value.y]&&o.value.x!==void 0&&o.value.y!==void 0&&(n.value[o.value.y][o.value.x]=3)},f=e=>{y.value==="up"&&e==="down"||y.value==="down"&&e==="up"||y.value==="left"&&e==="right"||y.value==="right"&&e==="left"||(w.value=e)},F=()=>{y.value=w.value;const e={...u.value[0]};switch(y.value){case"up":e.y!==void 0&&(e.y-=1);break;case"down":e.y!==void 0&&(e.y+=1);break;case"left":e.x!==void 0&&(e.x-=1);break;case"right":e.x!==void 0&&(e.x+=1);break}if(e.x!==void 0&&e.y!==void 0&&(e.x<0||e.x>=r||e.y<0||e.y>=r)){M();return}for(let a=0;a<u.value.length;a++){const s=u.value[a];if(s&&e.x!==void 0&&e.y!==void 0&&s.x===e.x&&s.y===e.y){M();return}}e.x!==void 0&&e.y!==void 0&&u.value.unshift({x:e.x,y:e.y}),e.x!==void 0&&e.y!==void 0&&o.value&&e.x===o.value.x&&e.y===o.value.y?(x.value+=10,m.value>se&&(m.value-=ne,t&&(clearInterval(t),t=null),t=window.setInterval(S,m.value)),A()):u.value.pop(),B()},M=()=>{if(g.value=!0,v.value=!1,x.value>h.value){h.value=x.value;try{localStorage.setItem("snakeHighScore",h.value.toString())}catch(e){console.error("无法保存最高分到localStorage:",e)}}t&&(clearInterval(t),t=null)},S=()=>{v.value&&!g.value&&F()},G=()=>{v.value||(v.value=!0,t||(t=window.setInterval(S,m.value)))},D=()=>{v.value=!1},I=()=>{t&&(clearInterval(t),t=null),E(),v.value=!0,t=window.setInterval(S,m.value)},L=e=>{switch(e.key){case"ArrowUp":f("up");break;case"ArrowDown":f("down");break;case"ArrowLeft":f("left");break;case"ArrowRight":f("right");break;case" ":g.value?I():v.value?D():G();break}},T=()=>{C.value=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)};return j(()=>{T(),E();try{const e=localStorage.getItem("snakeHighScore");e&&(h.value=parseInt(e,10))}catch(e){console.error("无法从localStorage加载最高分:",e)}window.addEventListener("keydown",L)}),z(()=>{t&&(clearInterval(t),t=null),window.removeEventListener("keydown",L)}),(e,a)=>(d(),c("div",J,[l("div",Q,[a[5]||(a[5]=l("h1",null,"贪吃蛇游戏",-1)),l("div",V,[l("div",W,"得分: "+N(x.value),1),l("div",X,"最高分: "+N(h.value),1),l("div",Y,[!v.value&&!g.value?(d(),c("button",{key:0,onClick:G,class:"start-btn"},"开始游戏")):_("",!0),v.value?(d(),c("button",{key:1,onClick:D,class:"pause-btn"},"暂停")):_("",!0),l("button",{onClick:I,class:"reset-btn"},"重新开始")])]),l("div",ee,[(d(!0),c(O,null,P(n.value,(s,k)=>(d(),c("div",{key:k,class:"board-row"},[(d(!0),c(O,null,P(s,(b,p)=>(d(),c("div",{key:p,class:Z(["cell",$(b)])},null,2))),128))]))),128))],512),C.value?(d(),c("div",ae,[l("div",te,[l("button",{onClick:a[0]||(a[0]=s=>f("up")),class:"control-btn up"},"↑")]),l("div",oe,[l("button",{onClick:a[1]||(a[1]=s=>f("left")),class:"control-btn left"},"←"),l("button",{onClick:a[2]||(a[2]=s=>f("down")),class:"control-btn down"},"↓"),l("button",{onClick:a[3]||(a[3]=s=>f("right")),class:"control-btn right"},"→")])])):_("",!0),g.value?(d(),c("div",le,[a[4]||(a[4]=K(" 游戏结束! ",-1)),l("button",{onClick:I},"重新开始")])):_("",!0)])]))}}),ue=q(re,[["__scopeId","data-v-88bdf6cc"]]);export{ue as default};
//# sourceMappingURL=SnakeGame-B6zyglpD.js.map
