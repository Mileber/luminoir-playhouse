import{d as W,a as _,c as S,o as z,i as $,b as r,e as l,f as g,t as p,F as B,g as x,n as F,h as i,_ as J}from"./index-LnyyPkwa.js";const U={class:"sokoban-game"},V={class:"game-info"},I={class:"game-controls"},K=["disabled"],j=["disabled"],q={class:"game-board",ref:"gameBoard"},H={key:0,class:"player"},Q={key:1,class:"box"},Z={key:2,class:"target"},ee={key:3,class:"wall"},te={key:0,class:"mobile-controls"},ne={class:"control-row"},oe={class:"control-row"},se={class:"control-row"},le={key:1,class:"win-overlay"},ae={class:"win-message"},re=W({__name:"SokobanGame",setup(ie){const e={EMPTY:0,WALL:1,BOX:2,TARGET:3,PLAYER:4,BOX_ON_TARGET:5,PLAYER_ON_TARGET:6},T=[[[1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,1],[1,0,2,2,2,2,0,1],[1,0,2,3,3,2,0,1],[1,0,2,3,3,2,0,1],[1,0,2,2,2,2,0,1],[1,0,0,0,4,0,0,1],[1,1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1,1,1],[1,0,0,0,1,0,0,0,1],[1,0,2,0,1,0,2,0,1],[1,0,2,0,3,0,2,0,1],[1,0,0,2,3,2,0,0,1],[1,1,1,0,3,0,1,1,1],[1,0,0,0,2,0,0,4,1],[1,0,0,0,1,0,0,0,1],[1,1,1,1,1,1,1,1,1]]],v=_(0),o=_([]),c=_({x:0,y:0}),y=_(0),b=_(!1),L=_(!1),k=()=>{const s=T[v.value];o.value=JSON.parse(JSON.stringify(s)),y.value=0,b.value=!1;for(let t=0;t<o.value.length;t++)for(let n=0;n<(o.value[t]?.length||0);n++)if(o.value[t]?.[n]===e.PLAYER||o.value[t]?.[n]===e.PLAYER_ON_TARGET){c.value={x:t,y:n};break}},P=S(()=>o.value.map(s=>[...s])),C=s=>{switch(s){case e.EMPTY:return"empty";case e.WALL:return"wall";case e.BOX:return"box";case e.TARGET:return"target";case e.PLAYER:return"player";case e.BOX_ON_TARGET:return"box-on-target";case e.PLAYER_ON_TARGET:return"player-on-target";default:return""}},d=(s,t)=>{if(b.value)return;const n=c.value.x+s,u=c.value.y+t;if(n<0||n>=o.value.length||u<0||u>=(o.value[0]?.length||0))return;const a=o.value[n]?.[u];if(a===void 0||a===e.WALL)return;if(a===e.BOX||a===e.BOX_ON_TARGET){const f=n+s,w=u+t;if(f<0||f>=o.value.length||w<0||w>=(o.value[0]?.length||0))return;const E=o.value[f]?.[w];if(E===void 0||E===e.WALL||E===e.BOX||E===e.BOX_ON_TARGET)return;const D=E===e.TARGET?e.BOX_ON_TARGET:e.BOX;o.value[f]&&(o.value[f][w]=D);const M=a===e.BOX?e.EMPTY:e.TARGET;o.value[n]&&(o.value[n][u]=M)}const A=o.value[c.value.x]?.[c.value.y]===e.PLAYER_ON_TARGET?e.TARGET:e.EMPTY,X=o.value[n]?.[u]===e.TARGET||o.value[n]?.[u]===e.BOX_ON_TARGET?e.PLAYER_ON_TARGET:e.PLAYER;o.value[c.value.x]&&(o.value[c.value.x][c.value.y]=A),o.value[n]&&(o.value[n][u]=X),c.value={x:n,y:u},y.value++,N()},N=()=>{let s=!0;for(let t=0;t<o.value.length;t++){for(let n=0;n<(o.value[t]?.length||0);n++)if(o.value[t]?.[n]===e.TARGET){s=!1;break}if(!s)break}s&&(b.value=!0)},R=s=>{switch(s.key){case"ArrowUp":d(-1,0),s.preventDefault();break;case"ArrowDown":d(1,0),s.preventDefault();break;case"ArrowLeft":d(0,-1),s.preventDefault();break;case"ArrowRight":d(0,1),s.preventDefault();break}},h=()=>{k()},m=()=>{v.value<T.length-1&&(v.value++,k())},Y=()=>{v.value>0&&(v.value--,k())},O=()=>{L.value=window.innerWidth<=768},G=()=>{O()};return z(()=>{k(),O(),window.addEventListener("keydown",R),window.addEventListener("resize",G)}),$(()=>{window.removeEventListener("keydown",R),window.removeEventListener("resize",G)}),(s,t)=>(i(),r("div",U,[t[5]||(t[5]=l("h1",null,"推箱子",-1)),l("div",V,[l("div",null,"关卡: "+p(v.value+1)+"/"+p(T.length),1),l("div",null,"步数: "+p(y.value),1)]),l("div",I,[l("button",{onClick:h},"重置"),l("button",{onClick:Y,disabled:v.value===0},"上一关",8,K),l("button",{onClick:m,disabled:v.value===T.length-1},"下一关",8,j)]),l("div",q,[(i(!0),r(B,null,x(P.value,(n,u)=>(i(),r("div",{key:u,class:"board-row"},[(i(!0),r(B,null,x(n,(a,A)=>(i(),r("div",{key:A,class:F(["cell",C(a)])},[a===4||a===6?(i(),r("div",H)):a===2||a===5?(i(),r("div",Q)):a===3?(i(),r("div",Z)):a===1?(i(),r("div",ee)):g("",!0)],2))),128))]))),128))],512),L.value?(i(),r("div",te,[l("div",ne,[l("button",{onClick:t[0]||(t[0]=n=>d(-1,0))},"↑")]),l("div",oe,[l("button",{onClick:t[1]||(t[1]=n=>d(0,-1))},"←"),l("button",{onClick:t[2]||(t[2]=n=>d(0,1))},"→")]),l("div",se,[l("button",{onClick:t[3]||(t[3]=n=>d(1,0))},"↓")])])):g("",!0),b.value?(i(),r("div",le,[l("div",ae,[t[4]||(t[4]=l("h2",null,"恭喜通关!",-1)),v.value<T.length-1?(i(),r("button",{key:0,onClick:m},"下一关")):(i(),r("button",{key:1,onClick:h},"重新开始"))])])):g("",!0)]))}}),ve=J(re,[["__scopeId","data-v-1e11e676"]]);export{ve as default};
//# sourceMappingURL=SokobanGame-Bm_KpYtF.js.map
