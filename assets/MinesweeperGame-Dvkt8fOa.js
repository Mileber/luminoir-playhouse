import{d as j,r as q,a as R,c as T,o as H,b as c,e as f,f as y,t as x,F as S,g as B,n as N,h as u,_ as J}from"./index-t4KvOpOu.js";const K={class:"minesweeper-game"},Q={class:"game-info"},U={key:0},X={key:1},Y=["onClick","onContextmenu","onTouchstart"],Z={key:0},ee={key:1},ne={key:2},d=9,v=9,k=10,te=j({__name:"MinesweeperGame",setup(se){const a=q([]),h=R(!1),m=R(!1),_=R(!0),A=T(()=>d*v),D=T(()=>{let s=0;for(let e=0;e<d;e++)for(let o=0;o<v;o++){const n=a[e];if(n){const t=n[o];t&&t.isRevealed&&s++}}return s}),b=()=>{a.length=0;for(let s=0;s<d;s++){const e=[];for(let o=0;o<v;o++)e.push({isMine:!1,isRevealed:!1,isFlagged:!1,neighborMines:0});a.push(e)}h.value=!1,m.value=!1,_.value=!0},E=(s,e)=>{let o=0;for(;o<k;){const n=Math.floor(Math.random()*d),t=Math.floor(Math.random()*v),l=Math.abs(n-s)<=1&&Math.abs(t-e)<=1,i=a[n];if(i){const r=i[t];r&&!r.isMine&&!l&&(r.isMine=!0,o++)}}},G=()=>{for(let s=0;s<d;s++)for(let e=0;e<v;e++){const o=a[s];if(o){const n=o[e];if(n&&!n.isMine){let t=0;for(let l=-1;l<=1;l++)for(let i=-1;i<=1;i++){if(l===0&&i===0)continue;const r=s+l,p=e+i;if(r>=0&&r<d&&p>=0&&p<v){const w=a[r];if(w){const F=w[p];F&&F.isMine&&t++}}}n.neighborMines=t}}}},C=(s,e)=>{const o=a[s];if(!o)return;const n=o[e];if(n&&!(h.value||m.value||n.isRevealed||n.isFlagged)){if(_.value&&(E(s,e),G(),_.value=!1),n.isRevealed=!0,n.isMine){h.value=!0,O();return}if(n.neighborMines===0)for(let t=-1;t<=1;t++)for(let l=-1;l<=1;l++){if(t===0&&l===0)continue;const i=s+t,r=e+l;if(i>=0&&i<d&&r>=0&&r<v){const p=a[i];if(p){const w=p[r];w&&!w.isRevealed&&!w.isFlagged&&C(i,r)}}}W()}},O=()=>{for(let s=0;s<d;s++)for(let e=0;e<v;e++){const o=a[s];if(o){const n=o[e];n&&n.isMine&&(n.isRevealed=!0)}}},W=()=>{D.value===A.value-k&&(m.value=!0,z())},z=()=>{for(let s=0;s<d;s++)for(let e=0;e<v;e++){const o=a[s];if(o){const n=o[e];n&&n.isMine&&(n.isFlagged=!0)}}},I=(s,e,o)=>{s.preventDefault();const n=a[e];if(!n)return;const t=n[o];t&&(h.value||m.value||t.isRevealed||(t.isFlagged=!t.isFlagged))};let g=null,M=null;const L=(s,e,o)=>{s.touches.length>1&&s.preventDefault(),M={r:e,c:o},g=window.setTimeout(()=>{if(M){const{r:n,c:t}=M,l=a[n];if(!l)return;const i=l[t];if(!i||h.value||m.value||i.isRevealed)return;i.isFlagged=!i.isFlagged,window.navigator&&window.navigator.vibrate&&window.navigator.vibrate(100)}g=null},500)},P=s=>{if(g!==null&&(clearTimeout(g),g=null,M)){const{r:e,c:o}=M;C(e,o)}M=null},V=s=>{g!==null&&(clearTimeout(g),g=null)},$=()=>{b()};return H(()=>{b()}),(s,e)=>(u(),c("div",K,[e[1]||(e[1]=f("h2",null,"扫雷游戏 🧨",-1)),f("div",Q,[f("p",null,"地雷数: "+x(k)),h.value?(u(),c("p",U,"游戏结束！踩到地雷了。")):m.value?(u(),c("p",X,"恭喜你，成功排雷！")):y("",!0),f("button",{onClick:$},"重新开始"),e[0]||(e[0]=f("div",{class:"touch-instructions"},[f("p",null,"移动设备操作说明:"),f("p",null,"- 点击: 揭示格子"),f("p",null,"- 长按: 标记/取消标记地雷")],-1))]),f("div",{class:N(["board",{"game-over":h.value,"game-won":m.value}])},[(u(!0),c(S,null,B(a,(o,n)=>(u(),c("div",{key:n,class:"row"},[(u(!0),c(S,null,B(o,(t,l)=>(u(),c("div",{key:l,class:N(["cell",{revealed:t.isRevealed,mine:t.isMine&&t.isRevealed,flagged:t.isFlagged,[`n${t.neighborMines}`]:t.isRevealed&&!t.isMine}]),onClick:i=>C(n,l),onContextmenu:i=>I(i,n,l),onTouchstart:i=>L(i,n,l),onTouchend:P,onTouchmove:V},[t.isFlagged?(u(),c("span",Z,"🚩")):t.isRevealed&&t.isMine?(u(),c("span",ee,"💣")):t.isRevealed&&t.neighborMines>0?(u(),c("span",ne,x(t.neighborMines),1)):y("",!0)],42,Y))),128))]))),128))],2)]))}}),ie=J(te,[["__scopeId","data-v-0015f092"]]);export{ie as default};
//# sourceMappingURL=MinesweeperGame-Dvkt8fOa.js.map
