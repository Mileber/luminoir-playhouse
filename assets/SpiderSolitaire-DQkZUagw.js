import{d as W,a as d,o as z,b as i,e as c,f as m,t as k,n as _,F as U,g as y,w as V,h as f,_ as H}from"./index-LnyyPkwa.js";const J={class:"spider-solitaire"},K={class:"game-info"},Q={class:"game-area"},R={class:"stock-area"},X={key:0,class:"card back"},Y={key:1,class:"card back offset-1"},Z={key:2,class:"card back offset-2"},x={class:"foundation-area"},I={class:"tableau"},ee=["onDrop"],te=["data-col","data-index","draggable","onDragstart","onClick"],ae={key:0,class:"card-face"},se=["onDrop"],le={key:0,class:"win-overlay"};var q=(p=>(p.SPADES="spades",p.HEARTS="hearts",p.DIAMONDS="diamonds",p.CLUBS="clubs",p))(q||{});const re=W({__name:"SpiderSolitaire",setup(p){const n=d(Array(10).fill(null).map(()=>[])),g=d([]),v=d(5),h=d(0),C=d(!1),r=d(null),b=d({fromColumn:-1,fromIndex:-1}),E=()=>{const t=[];for(let e=0;e<2;e++)for(const s of Object.values(q))for(let a=1;a<=13;a++)t.push({suit:s,value:a,faceUp:!1});return t},F=t=>{const e=[...t];for(let s=e.length-1;s>0;s--){const a=Math.floor(Math.random()*(s+1));[e[s],e[a]]=[e[a],e[s]]}return e},w=()=>{n.value=Array(10).fill(null).map(()=>[]),g.value=[],v.value=5,h.value=0,C.value=!1;let t=E();t=F(t);for(let e=0;e<10;e++){const s=e<4?6:5;for(let a=0;a<s;a++){const l=t.pop();l.faceUp=a===s-1,n.value[e]&&n.value[e].push(l)}}g.value=t},N=()=>{if(!(v.value<=0||g.value.length===0)){for(let t=0;t<10;t++)if(g.value.length>0&&n.value[t]){const e=g.value.pop();e.faceUp=!0,n.value[t].push(e)}v.value--,S()}},j=t=>{switch(t){case 1:return"A";case 11:return"J";case 12:return"Q";case 13:return"K";default:return t.toString()}},M=t=>{switch(t){case"hearts":case"diamonds":return"card-red";case"spades":case"clubs":return"card-black";default:return""}},G=t=>{switch(t){case"hearts":return"♥";case"diamonds":return"♦";case"spades":return"♠";case"clubs":return"♣";default:return""}},L=(t,e,s)=>{const a=n.value[t]?.[e];if(!a||!a.faceUp){s.preventDefault();return}if(!D(t,e)){s.preventDefault();return}b.value={fromColumn:t,fromIndex:e},s.dataTransfer?.setData("text/plain",`${t},${e}`),s.dataTransfer.effectAllowed="move"},D=(t,e)=>{const s=n.value[t];if(!s)return!1;for(let a=e;a<s.length-1;a++){const l=s[a],u=s[a+1];if(l&&u&&l.value!==u.value+1||u&&!u.faceUp)return!1}return!0},A=(t,e)=>{e.preventDefault();const s=b.value.fromColumn,a=b.value.fromIndex;s===-1||a===-1||$(s,a,t)},$=(t,e,s)=>{if(t===s)return;const a=n.value[t],l=n.value[s];if(!a||!l||!B(t,e,s))return;const u=a.splice(e);if(n.value[s]=[...l,...u],a.length>0){const o=a[a.length-1];o&&!o.faceUp&&(o.faceUp=!0)}S(),O()},B=(t,e,s)=>{const a=n.value[t],l=n.value[s];if(!a||!l||e>=a.length)return!1;const u=a[e];if(!u)return!1;if(l.length===0)return!0;const o=l[l.length-1];return!o||!o.faceUp?!1:u.value===o.value-1},S=()=>{for(let t=0;t<n.value.length;t++){const e=n.value[t];if(e&&e.length>=13){let s=!0,a=null;for(let l=0;l<13;l++){const u=e.length-13+l,o=e[u];if(!o){s=!1;break}if(!o.faceUp){s=!1;break}if(o.value!==13-l){s=!1;break}if(a===null)a=o.suit;else if(o.suit!==a){s=!1;break}}if(s){if(e.splice(e.length-13,13),h.value++,e.length>0){const l=e[e.length-1];l&&!l.faceUp&&(l.faceUp=!0)}S();return}}}},O=()=>{h.value===8&&(C.value=!0)},P=(t,e)=>{const s=n.value[t]?.[e];if(!s||!s.faceUp){r.value=null;return}if(!r.value){D(t,e)&&(r.value={colIndex:t,cardIndex:e});return}if(r.value.colIndex===t&&r.value.cardIndex===e){r.value=null;return}if(r.value.colIndex===t&&e>r.value.cardIndex){D(t,e)&&(r.value={colIndex:t,cardIndex:e});return}n.value[t]&&B(r.value.colIndex,r.value.cardIndex,t)&&$(r.value.colIndex,r.value.cardIndex,t),r.value=null},T=()=>{w()};return z(()=>{w()}),(t,e)=>(f(),i("div",J,[e[4]||(e[4]=c("h1",null,"蜘蛛纸牌",-1)),c("div",K,[c("div",null,"剩余牌堆: "+k(v.value),1),c("div",null,"完成: "+k(h.value)+"/8",1),c("button",{onClick:T},"新游戏")]),c("div",Q,[c("div",R,[c("div",{class:_(["stock-pile",{disabled:v.value===0}]),onClick:N},[v.value>0?(f(),i("div",X)):m("",!0),v.value>1?(f(),i("div",Y)):m("",!0),v.value>2?(f(),i("div",Z)):m("",!0)],2)]),c("div",x,[(f(!0),i(U,null,y(h.value,s=>(f(),i("div",{key:s,class:"completed-pile"},[...e[2]||(e[2]=[c("div",{class:"card back completed"},null,-1)])]))),128))])]),c("div",I,[(f(!0),i(U,null,y(n.value,(s,a)=>(f(),i("div",{key:a,class:"tableau-column",onDrop:l=>A(a,l),onDragover:e[1]||(e[1]=V(()=>{},["prevent"]))},[(f(!0),i(U,null,y(s,(l,u)=>(f(),i("div",{key:`${a}-${u}`,class:_(["card",{back:!l.faceUp,selected:r.value&&r.value.colIndex===a&&r.value.cardIndex===u}]),"data-col":a,"data-index":u,draggable:l.faceUp,onDragstart:o=>L(a,u,o),onClick:o=>P(a,u)},[l.faceUp?(f(),i("div",ae,[c("span",{class:_(["card-value",M(l.suit)])},k(j(l.value)),3),c("span",{class:_(["card-suit",M(l.suit)])},k(G(l.suit)),3)])):m("",!0)],42,te))),128)),s.length===0?(f(),i("div",{key:0,class:"empty-slot",onDrop:l=>A(a,l),onDragover:e[0]||(e[0]=V(()=>{},["prevent"]))},null,40,se)):m("",!0)],40,ee))),128))]),C.value?(f(),i("div",le,[c("div",{class:"win-message"},[e[3]||(e[3]=c("h2",null,"恭喜获胜!",-1)),c("button",{onClick:T},"再玩一局")])])):m("",!0)]))}}),ue=H(re,[["__scopeId","data-v-4e9364e5"]]);export{ue as default};
//# sourceMappingURL=SpiderSolitaire-DQkZUagw.js.map
